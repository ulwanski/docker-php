FROM php:7.3-cli-alpine

# docker build --compress -t ulwanski/php:7.3-cli-dev -f php7.3-cli-dev .
MAINTAINER Marek Ulwa≈Ñski <marek@ulwanski.pl>

RUN apk update && apk add --upgrade --no-cache $PHPIZE_DEPS libzip-dev=1.5.1-r1 bzip2-dev=1.0.6-r6 git=2.18.1-r0
RUN docker-php-ext-configure zip --with-libzip && docker-php-ext-install pdo_mysql bcmath mbstring exif opcache zip bz2 sockets

RUN pecl install redis-4.2.0 apcu-5.1.16 && docker-php-ext-enable redis apcu

RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer

COPY conf.d/* $PHP_INI_DIR/conf.d/
COPY ./php.ini-production $PHP_INI_DIR/php.ini
